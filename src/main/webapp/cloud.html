<!DOCTYPE html>
<html>
<script src="resources/js/d3.v3.min.js"></script>
<script src="resources/js/jquery-2.1.0.js"></script>
<script src="resources/jquery-ui/jquery-ui.js"></script>
<script src="resources/js/jstree/src/jstree.js"></script>
<script src="resources/js/jstree/src/jstree.checkbox.js"></script>

<link rel="stylesheet"
	href="resources/js/jstree/dist/themes/default/style.min.css" />
<link href="resources/bootstrap/css/bootstrap.min.css" rel="stylesheet"></link>
<link href="resources/bootstrap/css/bootstrap-theme.min.css"
	rel="stylesheet"></link>
<link href="resources/css/dyn-lod.css" rel="stylesheet"></link>

<script src="resources/js/dyn-lod.js"></script>
<style>
path.link {
	fill: none;
	stroke: #666;
	stroke-width: 1.5px;
}

circle {
	fill: #ccc;
	stroke: #fff;
	stroke-width: 1.5px;
}

text {
	fill: #000;
	font: 10px sans-serif;
	pointer-events: none;
}
</style>

<script>
	$(function() {
		$("#menu").load("menu.html");
	});
</script>
<script src="resources/js/dyn-lod.js"></script>

<body>
	<div id="menu"></div>

	<div style="margin-left: 15px;">

		<div class="page-header">
			<h2>LOD-Diagram</h2>
		</div>

		<div class="row">
			<div class="col-md-3">
				<div id="tree"></div>

				<button onclick="submitMe()">Filter</button>

			</div>
			<div class="col-md-9">
				<div
					style="width: 680px; height: 700px; border: 1px solid #d8d8d8; margin-top: 40px; margin-right: 50px">
					<div id="diagram"
						style="margin-top: 10px; margin-right: 10px; margin-left: 10px;">

					</div>
				</div>
			</div>
		</div>
	</div>

</body>
<script type="text/javascript">
	$.post("ResourceTree", function(data) {
		$('#tree').jstree({
			"core" : {"data": data,
				 'animation' : 0,
				 "themes":{
			            "icons":false
			        }
				 } ,

			"checkbox" : {
				 "three_state": false,
				 "real_checkboxes" : true ,
				 "cascade" : "down" 
			},
			"plugins" : [ "themes", "html_data", "checkbox", "ui" ]
		});
		data
	}, 'json');

	function submitMe() {

		var result = "";
		$('#tree').jstree('get_checked').forEach(function(l) {
			if(isValidURL(l))
				result = result + l + "&dataset="; 
		});

		//	var result = "";
		//		$(".jstree-clicked").each(function(i, element) {
		//			result = result + $(element).attr("id") + "&dataset=";
		//		});
		if (result != "") {
			result = result.substring(0, result.length - 9);
		}
		makeGraph(result);
		
	}
	
	function isValidURL(url){
	    var RegExp = /(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;

	    if(RegExp.test(url)){
	        return true;
	    }else{
	        return false;
	    }
	} 
</script>
</html>
